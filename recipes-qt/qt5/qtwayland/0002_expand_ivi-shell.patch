From 74e146ac208dcbfc34c99d903e9827ef2b932046 Mon Sep 17 00:00:00 2001
From: Tasuku Suzuki <tasuku.suzuki@qt.io>
Date: Wed, 9 Nov 2016 16:33:28 +0900
Subject: [PATCH] Change QWindow::visible when surface visibility in ivi shell
 is changed

Change-Id: I2c2debe47fcb173f02aef5f4e60e52c35ad7b395
Reviewed-by: Yusuke Binsaki <yusuke.binsaki@itage.co.jp>
Reviewed-by: Giulio Camuffo <giulio.camuffo@kdab.com>
---
 src/plugins/shellintegration/ivi-shell/qwaylandivisurface.cpp | 5 +++++
 src/plugins/shellintegration/ivi-shell/qwaylandivisurface_p.h | 1 +
 2 files changed, 6 insertions(+)

diff --git a/src/plugins/shellintegration/ivi-shell/qwaylandivisurface.cpp b/src/plugins/shellintegration/ivi-shell/qwaylandivisurface.cpp
index ecc47e0..a2c7788 100644
--- a/src/plugins/shellintegration/ivi-shell/qwaylandivisurface.cpp
+++ b/src/plugins/shellintegration/ivi-shell/qwaylandivisurface.cpp
@@ -89,6 +89,11 @@ void QWaylandIviSurface::ivi_surface_configure(int32_t width, int32_t height)
     this->m_window->configure(0, width, height);
 }
 
+void QWaylandIviSurface::ivi_controller_surface_visibility(int32_t visibility)
+{
+    this->m_window->window()->setVisible(visibility != 0);
+}
+
 }
 
 QT_END_NAMESPACE
diff --git a/src/plugins/shellintegration/ivi-shell/qwaylandivisurface_p.h b/src/plugins/shellintegration/ivi-shell/qwaylandivisurface_p.h
index 9ac81ad..e332ce7 100644
--- a/src/plugins/shellintegration/ivi-shell/qwaylandivisurface_p.h
+++ b/src/plugins/shellintegration/ivi-shell/qwaylandivisurface_p.h
@@ -61,6 +61,7 @@ public:
 private:
     void createExtendedSurface(QWaylandWindow *window);
     virtual void ivi_surface_configure(int32_t width, int32_t height) Q_DECL_OVERRIDE;
+    void ivi_controller_surface_visibility(int32_t visibility) Q_DECL_OVERRIDE;
 
     QWaylandWindow *m_window;
     QWaylandExtendedSurface *m_extendedWindow;
-- 
2.7.4


